<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Exclusiva de Recursos - Kit Emprendedor</title>
    
    <style>
        /* Estilos Originales Preservados con Mejoras de UI */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #ccc;
            transition: all 0.3s ease;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background-color: #1a1a1a;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }

        h1 {
            color: #A9A9A9;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        /* Nuevo Selector de Moneda con Banderas Reales */
        .currency-selector-container {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 30px;
            padding: 15px;
            background-color: #222;
            border-radius: 8px;
            flex-wrap: wrap;
            border: 1px solid #333;
        }

        .currency-btn {
            background: #333;
            border: 1px solid #444;
            color: #fff;
            border-radius: 6px;
            padding: 8px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .currency-btn:hover {
            border-color: #FFC439;
            background: #3a3a3a;
        }

        .currency-btn.active {
            background: #FFC439;
            color: #000;
            border-color: #FFC439;
        }

        .flag-img {
            width: 20px;
            height: 14px;
            object-fit: cover;
            border-radius: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .product-card {
            background-color: #222;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
            border: 1px solid #333;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.2);
        }

        .product-card h3 {
            color: #A9A9A9;
            margin-top: 10px;
            font-size: 1.5em;
        }

        .product-card p {
            font-size: 0.9em;
            color: #999;
            min-height: 40px;
        }

        .price {
            font-size: 1.8em;
            font-weight: bold;
            color: #fff;
            margin: 15px 0;
        }
        
        .variant-button {
            background-color: #A9A9A9;
            color: #000;
            border: none;
            padding: 12px 20px;
            margin: 10px auto;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            font-size: 1.1em;
            font-weight: bold;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            width: 90%; 
        }

        .variant-button:hover {
            background-color: #fff; 
            color: #000;
        }
        
        .variant-button.selected {
            background-color: #FFC439; 
            color: #111;
            box-shadow: 0 0 10px #FFC439;
        }

        .variant-button .paypal-text {
            color: #003087; 
            font-weight: 800;
            margin-left: 5px;
        }

        #floating-cart {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background-color: #222;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.4);
            z-index: 1000;
            display: none;
            border: 2px solid #A9A9A9;
        }

        #floating-cart h3 {
            color: #A9A9A9;
            margin-top: 0;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        #floating-cart p {
            margin: 5px 0;
            color: #ccc;
        }

        #floating-cart strong {
            color: #fff;
        }

        #paypal-button-container {
            margin-top: 15px;
            min-height: 150px;
        }

        #custom-alert-box {
            position: fixed; 
            top: 20px; 
            right: 20px; 
            max-width: 300px;
            background: #B22222;
            color: white; 
            padding: 15px; 
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5); 
            z-index: 9999;
            opacity: 0; 
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .loading-text {
            color: #888;
            font-size: 0.8em;
            text-align: center;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Selecciona la Versión de Tu Kit de Emprendimiento</h1>

        <!-- Selector de Moneda Modernizado con Banderas y Franco Suizo -->
        <div class="currency-selector-container">
            <button class="currency-btn active" id="btn-USD" onclick="handleCurrencyUpdate('USD')">
                <img src="https://flagcdn.com/w40/us.png" class="flag-img" alt="USD"> USD
            </button>
            <button class="currency-btn" id="btn-EUR" onclick="handleCurrencyUpdate('EUR')">
                <img src="https://flagcdn.com/w40/eu.png" class="flag-img" alt="EUR"> EUR
            </button>
            <button class="currency-btn" id="btn-GBP" onclick="handleCurrencyUpdate('GBP')">
                <img src="https://flagcdn.com/w40/gb.png" class="flag-img" alt="GBP"> GBP
            </button>
            <button class="currency-btn" id="btn-CHF" onclick="handleCurrencyUpdate('CHF')">
                <img src="https://flagcdn.com/w40/ch.png" class="flag-img" alt="CHF"> CHF
            </button>
        </div>

        <div class="product-grid">
            <div class="product-card">
                <h3>Kit Digital Básico</h3>
                <p>Acceso a la guía principal y plantillas esenciales.</p>
                <div class="price" id="price-1" data-usd-price="19.99">$19.99 USD</div> 
                <button class="variant-button" data-id="1" data-title="Kit Digital Básico" data-price="19.99" onclick="selectProduct(this)">
                    Comprar Ahora <span class="paypal-text">| PayPal</span>
                </button>
            </div>

            <div class="product-card">
                <h3>Kit Digital Premium</h3>
                <p>Incluye guía avanzada, 1 hora de consultoría y recursos exclusivos.</p>
                <div class="price" id="price-2" data-usd-price="49.99">$49.99 USD</div>
                <button class="variant-button" data-id="2" data-title="Kit Digital Premium" data-price="49.99" onclick="selectProduct(this)">
                    Comprar Ahora <span class="paypal-text">| PayPal</span>
                </button>
            </div>

            <div class="product-card">
                <h3>Kit Mentor Master</h3>
                <p>Todo lo anterior más un mes de soporte ilimitado.</p>
                <div class="price" id="price-3" data-usd-price="99.99">$99.99 USD</div>
                <button class="variant-button" data-id="3" data-title="Kit Mentor Master" data-price="99.99" onclick="selectProduct(this)">
                    Comprar Ahora <span class="paypal-text">| PayPal</span>
                </button>
            </div>
        </div>
    </div>
    
    <div style="text-align: center; margin-top: 40px; margin-bottom: 50px;">
        <p id="selection-hint" style="color: #999;">
            *Por favor, selecciona un kit para habilitar el pago.*
        </p>
    </div>

    <div id="floating-cart">
        <h3>Tu Compra Rápida</h3>
        <p>Producto: <strong id="cart-title">Ninguno</strong></p>
        <p>Total: <strong id="cart-price">$0.00 USD</strong></p> 
        
        <div id="loading-indicator" class="loading-text" style="display:none;">Cargando PayPal...</div>
        <div id="paypal-button-container"></div>
        
        <p style="font-size: 0.8em; text-align: center; color: #888; margin-top: 10px;">
            Pago 100% seguro vía PayPal.
        </p>
    </div>

    <footer>
        <div style="background-color: #111; color: #666; padding: 15px; text-align: center; margin-top: 20px;">
            &copy; 2025 **Héctor Mauricio Raposso**. Todos los derechos reservados.
        </div>
    </footer>
    
    <div id="custom-alert-box"></div>

    <script>
        const CLIENT_ID = "ATlkn4MmFU8Pgsjqn22Oro_M5s83QVMzU3pmhenHTU6oIXI3wjPtTDIpwSNk4Dj1OsxlWEZyPRZEMFnB";
        let selectedProductData = null;
        let currentCurrency = 'USD';

        // Tasas de conversión y símbolos
        const conversionRates = { 'USD': 1.0, 'EUR': 0.93, 'CHF': 0.89, 'GBP': 0.81 };
        const symbols = { 'USD': '$', 'EUR': '€', 'CHF': 'Fr.', 'GBP': '£' };

        function customAlert(message) {
            const alertBox = document.getElementById('custom-alert-box');
            alertBox.textContent = message;
            alertBox.style.opacity = '1';
            setTimeout(() => { alertBox.style.opacity = '0'; }, 4000);
        }

        function handleCurrencyUpdate(code) {
            currentCurrency = code;
            
            // Actualizar estilo de botones
            document.querySelectorAll('.currency-btn').forEach(btn => {
                btn.classList.toggle('active', btn.id === `btn-${code}`);
            });

            updateDisplayPrices();
            
            if (selectedProductData) {
                refreshCartUI();
                loadPayPalSDK();
            }
        }

        function updateDisplayPrices() {
            document.querySelectorAll('.price').forEach(el => {
                const usd = parseFloat(el.getAttribute('data-usd-price'));
                const converted = usd * conversionRates[currentCurrency];
                el.textContent = `${symbols[currentCurrency]}${converted.toFixed(2)} ${currentCurrency}`;
            });
        }

        function selectProduct(btn) {
            document.querySelectorAll('.variant-button').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');

            selectedProductData = {
                id: btn.getAttribute('data-id'),
                title: btn.getAttribute('data-title'),
                basePriceUSD: parseFloat(btn.getAttribute('data-price'))
            };

            refreshCartUI();
            document.getElementById('floating-cart').style.display = 'block';
            document.getElementById('selection-hint').style.display = 'none';
            
            loadPayPalSDK();
        }

        function refreshCartUI() {
            if (!selectedProductData) return;
            const finalPrice = selectedProductData.basePriceUSD * conversionRates[currentCurrency];
            document.getElementById('cart-title').textContent = selectedProductData.title;
            document.getElementById('cart-price').textContent = `${symbols[currentCurrency]}${finalPrice.toFixed(2)} ${currentCurrency}`;
        }

        function loadPayPalSDK() {
            const container = document.getElementById('paypal-button-container');
            container.innerHTML = '';
            document.getElementById('loading-indicator').style.display = 'block';

            const existingScript = document.getElementById('paypal-script-tag');
            if (existingScript) existingScript.remove();

            const script = document.createElement('script');
            script.id = 'paypal-script-tag';
            script.src = `https://www.paypal.com/sdk/js?client-id=${CLIENT_ID}&currency=${currentCurrency}`;
            script.onload = renderButtons;
            script.onerror = () => {
                document.getElementById('loading-indicator').style.display = 'none';
                customAlert("Error al cargar el sistema de pagos.");
            };
            document.head.appendChild(script);
        }

        function renderButtons() {
            document.getElementById('loading-indicator').style.display = 'none';
            const price = (selectedProductData.basePriceUSD * conversionRates[currentCurrency]).toFixed(2);

            paypal.Buttons({
                style: { layout: 'vertical', color: 'gold', shape: 'rect', height: 45 },
                createOrder: function(data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            description: selectedProductData.title,
                            amount: {
                                currency_code: currentCurrency,
                                value: price
                            }
                        }]
                    });
                },
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                        customAlert("¡Pago exitoso! Gracias, " + details.payer.name.given_name);
                        document.getElementById('floating-cart').style.display = 'none';
                    });
                },
                onError: function(err) {
                    console.error(err);
                    customAlert("Hubo un problema con la transacción.");
                }
            }).render('#paypal-button-container');
        }

        window.onload = updateDisplayPrices;
    </script>
</body>
</html>